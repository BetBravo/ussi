{% extends 'base.html.twig' %}
{% block stylesheets %}
    <!-- sweetalert2 -->
    <script src="{{ asset('bundles/app/vendors/sweetalert2/sweetalert2.min.js')}}"></script>
    <link href="{{ asset('bundles/app/vendors/sweetalert2/sweetalert2.min.css')}}" rel="stylesheet">
{% endblock %}
{% block body %}
    <div class="x_content">
        <h1>Cita consulta</h1>
        <h2>Servicios Disponibles</h2>
        <table class="table">
            <thead>
                <tr>
                    <th>Id</th>
                    <th>Especialidad</th>
                    <th>Día</th>
                    <th>Turno</th>
                    <th>Procedencia</th>
                    <th>Cupos</th> 
                    <th>Disponibles</th>
                    <th>Preferencia</th>
                </tr>
            </thead>
            <tbody>
                {% for servicio in servicios %}
                    <tr>
                        <td><a href="{{ path('servicio_show', { 'id': servicio.id }) }}">{{ servicio.id }}</a></td>
                        <td id='n-e-{{ loop.index}}'>{{ servicio.especialidad.nombre }}</td>
                        <td>
                            {% set dia = ['Domingo','Lunes','Martes','Miércoles','Jueves','Viernes','Sábado'] %}
                            {{ dia[servicio.dia] }}
                        </td>
                        <td>{{ servicio.turno | title }}</td>
                        <td>{{ servicio.procedencia }}</td>
                        <td>{{ servicio.cupo }}</td>          
                        <td>{{ servicio.disponible }}</td>
                        <td> <button class="btn btn-default btn-especialidad" id="e-{{ loop.index}}">Seleccionar</button></td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>




        <br>
        {{ form_start(form, { 'attr': {'id':'paciente','class': 'form-horizontal form-label-left'} }) }} 
        {{ form_errors(form) }}
        <div class="form-group">
            <label class="control-label col-md-3 col-sm-3 col-xs-12" for="nacionalidad">{{ form_label(form.nacionalidad) }} <span class="required">*</span></label>
            <div class="col-md-6 col-sm-6 col-xs-12">
                {{ form_errors(form.nacionalidad) }}                
                {{form_widget(form.nacionalidad,{ 'attr': {'class': 'form-control col-md-7 col-xs-12'} } ) }}                
            </div>
        </div>

        <div class="form-group">
            <label class="control-label col-md-3 col-sm-3 col-xs-12" for="cedula">{{ form_label(form.cedula) }} <span class="required">*</span></label>
            <div class="col-md-6 col-sm-6 col-xs-12">
                {{ form_errors(form.cedula) }}                
                {{form_widget(form.cedula,{ 'attr': {'class': 'form-control col-md-7 col-xs-12'} } ) }}                
            </div>
        </div>

        <div class="form-group">
            <label class="control-label col-md-3 col-sm-3 col-xs-12" for="especialidad">{{ form_label(form.especialidad) }} <span class="required">*</span></label>
            <div class="col-md-6 col-sm-6 col-xs-12">
                {{ form_errors(form.especialidad) }}                
                {{form_widget(form.especialidad,{ 'attr': {'class': 'form-control col-md-7 col-xs-12'} } ) }}                
            </div>
        </div>

        <div class="ln_solid"></div>
        <div class="form-group">
            <div class="col-md-6 col-sm-6 col-xs-12 col-md-offset-3">                
                <button type="submit" class="btn btn-success">Registrar</button>
            </div>
        </div>

        {{ form_end(form) }}        

    </div>

        <ul>
            <li>
                <a href="{{ path('cita_index') }}">Back to the list</a>
            </li>
        </ul>
    {% endblock %}

    {% block javascripts %}
        <script>
            $(document).ready(function () {
                $("#paciente").hide();
                $(".btn-especialidad").click(function () {
                    $("#paciente").show();
                    $('#form_especialidad').val($("#n-" + $(this).prop('id')).html());

                });


                if (( {% if (profesionalDisponible!=null and profesionalDisponible.status=='inactivo')  %} 1 {% else %} 0{% endif %}) == 1) {
                    //swal('Oops...', 'Doctor No Disponible', 'error').catch(swal.noop)
                    swal({
                        title: 'Cita Sucesiva - Doctor No Disponible',
                        text: "{% if (profesionalDisponible!=null and profesionalDisponible.status=='inactivo')  %} 
		Dr. {{profesionalDisponible.profesional.persona.primerNombre}} {{profesionalDisponible.profesional.persona.primerApellido}} - {{profesionalDisponible.observacion}}
	{% endif %}",
                        type: 'warning',
                        showCancelButton: true,
                        confirmButtonColor: '#3085d6',
                        cancelButtonColor: '#d33',
                        confirmButtonText: 'Otro Doctor!'
                    }).then(function () {
                        //swal('Procesando!','Fue agregada a la lista de espera.','success')
                        window.location.href = "http://www.bufa.es";
                    })
                }


            });
        </script>
        <!-- /Datatables -->
    {% endblock %}